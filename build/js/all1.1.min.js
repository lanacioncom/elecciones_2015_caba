var ElecionesApp=function(t,a){"use strict";function o(t){$("#selected h4").html(t).fadeIn()}var e=this;e.list_partidos=t,e.r_general=a.general,e.internas=a.interna,e.comuna_active_path=null,e.filtro_home="x_fuerza",e.filtro_activo="x_fuerza",e.ganadores_comunas=[];for(var i in e.r_general.comunas){var n=e.r_general.comunas[i][0];n.comuna=i.replace(/omuna_/i,""),e.ganadores_comunas.push(e.r_general.comunas[i][0])}console.log(e.ganadores_comunas),function(){$("select#opts").change(function(){e.change_dropdown($(this).val())}),$("h3").on("click",function(){e.filtro_activo=e.filtro_home,e.reset(),$("select#opts").select2("val",e.filtro_activo)}),e.tmpl_opts=Handlebars.compile($("#tmpl_opts").html()),$("#opts").html(e.tmpl_opts(e.list_partidos)),e.cont_results=$("#results"),e.tmpl_li_partido=Handlebars.compile($("#tmpl_li_partido").html()),e.tmpl_x_interna=Handlebars.compile($("#tmpl_x_interna").html()),e.draw_ul_list(),e.tooltip=$("#tooltip"),e.tmpl_tooltip=Handlebars.compile($("#tmpl_tooltip").html()),e.on_click_comuna(),e.pintar_mapa(),tooltip()}(),this.set_data_active=o};ElecionesApp.prototype.select_comuna_interna=function(t){var a=this,o=t.id.replace(/c/i,""),e="Comuna "+o;a.set_data_active(e),a.set_comuna_active_path(t),a.q.set("comuna",o);var i={total:a.internas.comunas["comuna_"+o],porcentaje:33.5};a.draw_x_interna(i)},ElecionesApp.prototype.select_comuna_general=function(t){var a=this,o=t.id.replace(/c/i,""),e="Comuna "+o;a.set_data_active(e),a.q.set("comuna",o),a.draw_ul_list(a.r_general.comunas["comuna_"+o])},ElecionesApp.prototype.on_click_comuna=function(){var t=this;$("polygon, path").on("click.on_comuna",function(){t.filtro_activo==t.filtro_home?t.select_comuna_general(this):t.select_comuna_interna(this)})},ElecionesApp.prototype.reset=function(){$("#selected h4").hide().html(""),this.remove_comuna_active_path(),this.filtro_activo==this.filtro_home?(this.draw_ul_list(),this.q.kill("comuna")):this.draw_x_interna(),$("li.candidato.active input").prop("checked",!1),$("li.candidato.active").removeClass("active")},ElecionesApp.prototype.get_max_obj=function(t,a){var o=t.map(function(t){return t[a]});return Math.max.apply(null,o)},ElecionesApp.prototype.sort_obj=function(t,a){function o(t,o){return t[a]>o[a]?-1:t[a]<o[a]?1:0}return t.sort(o)},ElecionesApp.prototype.draw_ul_list=function(t){var a=!1;t?a=!0:t=this.r_general.total,this.sort_obj(t,"porcentaje");var o=(t.map(function(t){return t.porcentaje}),{data:t,is_comuna:a,max:this.get_max_obj(t,"porcentaje")});this.cont_results.html(this.tmpl_li_partido(o)),a?$(".help_text, #line").hide():$(".help_text, #line").show(),this.start_niceScroll("#list")},ElecionesApp.prototype.draw_x_interna=function(t){t||(t=this.internas);var a=this;a.cont_results.html(this.tmpl_x_interna(t));var o=$('input[type="radio"]');o.on("click.select_condidato",function(){var t=$(this);$("li.active:has(input)").removeClass("active"),t.closest("li").addClass("active"),a.set_data_active(this.value),a.q.set("candidato",this.value)}),a.start_niceScroll()},ElecionesApp.prototype.draw_tooltip=function(t){this.tooltip.html(this.tmpl_tooltip(t))},ElecionesApp.prototype.remove_comuna_active_path=function(){this.comuna_active_path&&this.comuna_active_path.remove()},ElecionesApp.prototype.set_comuna_active_path=function(t){this.remove_comuna_active_path(),this.comuna_active_path=$(t).clone(),this.comuna_active_path.attr("class","comuna_active_path"),$("svg").append(this.comuna_active_path)},ElecionesApp.prototype.change_dropdown=function(t){this.filtro_activo=t;var a="x_fuerza";$("#ayud1").hide(),$(".compartir").show(),a==this.filtro_activo?this.draw_ul_list():this.draw_x_interna(),this.q.set("fuerza",t)},ElecionesApp.prototype.start_niceScroll=function(t){$(t).niceScroll({cursorcolor:"#d7d7d7",cursorborder:"0px solid #fff",cursorwidth:"7px",autohidemode:!1,hidecursordelay:0})},ElecionesApp.prototype.pintar_mapa=function(){var t=this;"x_fuerza"==this.filtro_activo&&t.ganadores_comunas.forEach(function(a){$("#"+a.comuna).css({fill:t.colores[a.id]})})},ElecionesApp.prototype.barios_x_com={c1:"Recoleta",c2:"Palermo",c3:"Barracas, Boca, Nueva Pompeya, Parque Patricios ",c4:"Constitución, Monserrat, Puerto Madero, Retiro, San Nicolás, San Telmo",c5:"Belgrano, Colegiales, Nuñez",c6:"Almagro, Boedo",c7:"Caballito",c8:"Flores, Parque Chacabuco",c9:"Liniers, Mataderos, Parque Avellaneda",c10:"Floresta, Monte Castro, Velez Sarsfield, Versalles, Villa Luro, Villa Real",c11:"Villa Del Parque, Villa  Devoto, Villa Gral. Mitre, Villa Santa Rita",c12:"Coghlan, Saavedra, Villa Pueyrredón, Villa Urquiza",c13:"Balvanera, San Cristobal",c14:"Agronomía, Chacarita,  Parque Chas,  Paternal, Villa Crespo, Villa Ortuzar",c15:"Villa Lugano, Villa Riachuelo, Villa Soldati"},ElecionesApp.prototype.q=new PermanentLinkJS,ElecionesApp.prototype.colores=["#FEDB30","#1796D7","#7CC374","#F4987E","#B185B7","#B3B3B3"];
var PermanentLinkJS=function(){"use strict";function t(){return c={},i(),c}function r(t,r){if("object"==typeof t)try{for(var e in t)c[e]=t[e]}catch(n){console.error("Error set query: %s",n.message)}else try{c[t]=r,i()}catch(n){console.error("Error set query: %s",n.message)}return c}function e(t){return t=t||location.hash,t.replace("#","").split("&").map(function(t){return t=t.split("="),this[t[0]]=t[1],this}.bind({}))[0]}function n(){return c=e()}function s(t){return delete c[t],i(),c}function o(t){var r=[];for(var e in t)r.push([e,t[e]].join("="));return r.join("&")}function i(t){t="string"==typeof t?t:o(t||c);try{return location.hash=t}catch(r){console.error("Error set_hash: %s",r.message)}}var c={};this.get_query=function(){return c},this.reset=t,this.get_parameters=e,this.to_string=o,this.set_hash=i,this.set=r,this.kill=s,this.set_from_location=n};
function tooltip(){function e(e,a){e.on("mousemove",function(e){e=e||window.event,e=jQuery.event.fix(e);var a=e.pageX-200;e.pageX>185&&750>ancho?a=e.pageX-200:e.pageX<330&&(a=e.pageX),itemY=e.pageY>350&&750>ancho?e.pageY-260:e.pageY>350?e.pageY-260:e.pageY+30,$(".tooltip").animate({top:itemY,left:a},100,"swing").stop(!0,!0)}),isMobile.any()||e.on("mouseout",function(){a.hide()})}var a=$("polygon, path"),i=$(".tooltip");a.on("mouseenter",function(){if($el=$(this),ide=$el.attr("id").replace(/c/i,""),"x_fuerza"==app.filtro_activo){var a=app.r_general.comunas["comuna_"+ide],o=app.get_max_obj(a,"porcentaje");a=app.sort_obj(a,"porcentaje"),app.draw_tooltip({id:ide,max:o,comuna:a,barios_x_com:app.barios_x_com["c"+ide]}),i.show(),e($el,i)}else app.draw_tooltip()})}var app,ancho=$(window).width(),isMobile={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return isMobile.Android()||isMobile.BlackBerry()||isMobile.iOS()||isMobile.Opera()||isMobile.Windows()}};$(function(){"use strict";$.get("img/caba_ilus.txt",function(e){$.get("data/list_partidos.json",function(a){$.get("data/results_example.json",function(i){$("#mapa_cont").html(e+'<div class="ayuda2">FILTRAR POR CANDIDATO</div><div class="ayuda3">Clickeá en las comunas para ver los resultados en detalle.</div></div>'),app=new ElecionesApp(a,i),$("#opts").select2({minimumResultsForSearch:-1,val:"x_fuerza"})})})})});
//# sourceMappingURL=../js/all1.1.min.js.map