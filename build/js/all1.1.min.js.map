{"version":3,"sources":["elecciones_app.js","permanentlinkjs.js","scripts.js"],"names":["ElecionesApp","dict_partidos","dict_candidatos","results","set_data_active","str","$","html","fadeIn","s","this","r_general","internas","interna","comuna_active_path","filtro_home","filtro_activo","get_ganadores_x_comuna","change","change_dropdown","val","on","reset","select2","tmpl_opts","Handlebars","compile","cont_results","tmpl_li_partido","tmpl_x_interna","draw_ul_list","tooltip","tmpl_tooltip","on_click_comuna","prototype","data","ganadores_comunas","com","test","i","id","c","comuna","replace","push","pintar_mapa","select_comuna_interna","polygon","com_name","q","set","total","comunas","porcentaje","draw_x_interna","select_comuna_general","set_comuna_active_path","hide","remove_comuna_active_path","kill","prop","removeClass","get_max_obj","arr","key","max","map","x","Math","apply","sort_obj","compare","a","b","sort","is_comuna","c_00","l","p","show","start_niceScroll","cache_ajax","run_interna","key_cache","candidato_btn","$el","closest","addClass","value","get","draw_tooltip","remove","clone","attr","append","selector","niceScroll","cursorcolor","cursorborder","cursorwidth","autohidemode","hidecursordelay","fill","forEach","css","color_partido","color_candidato","stroke","barios_x_com","c1","c2","c3","c4","c5","c6","c7","c8","c9","c10","c11","c12","c13","c14","c15","PermanentLinkJS","colores","query","set_hash","k","err","console","error","message","get_parameters","location","hash","split","n","bind","set_from_location","to_string","o","join","get_query","mouse_move","toolip","e","window","event","jQuery","fix","itemX","pageX","ancho","itemY","pageY","animate","top","left","stop","isMobile","any","comu","ide","app","slice","d","color","nombre","nombre_partido","partidos","width","Android","navigator","userAgent","match","BlackBerry","iOS","Opera","Windows","mapa","minimumResultsForSearch"],"mappings":"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","file":"js/all1.1.min.js","sourcesContent":["// Elecciones class\nvar ElecionesApp = function(dict_partidos, dict_candidatos, results){\n\t\"use strict\";\n\t// set self class var\n\tvar s = this;\n\ts.dict_partidos = dict_partidos;\n\ts.dict_candidatos = dict_candidatos;\n\ts.r_general = results;\n\ts.internas = results.interna;\n\ts.comuna_active_path = null;\n\ts.filtro_home = \"00\"; // filtro seteado por default\n\ts.filtro_activo = \"00\";\n\t// s.r_internas = results.inernas;\n\n\tfunction set_data_active(str){\n\t\t$(\"#selected h4\").html(str).fadeIn();\n\t}\n\n\n\t(function init(){\n\t\t// data colores mapa...\n\t\ts.get_ganadores_x_comuna(s.r_general); // pinta el mapa\n\n\t\t// bind events\n\n\t\t// change dropdown\n\t\t$('select#opts').change(function(e){\n\t\t\ts.change_dropdown($(this).val());\n\t\t});\n\t\t$('h3').on('click', function(){ // volver a la home \n\t\t\ts.filtro_activo = s.filtro_home;\n\t\t\ts.reset();\n\t\t\t$('select#opts').select2(\"val\", s.filtro_home);\n\t\t});\n\t\t\n\t\t// template para el select de internas\n\t\ts.tmpl_opts = Handlebars.compile($('#tmpl_opts').html());\n\t\t$(\"#opts\").html( s.tmpl_opts(s.dict_partidos) );\n\t\t\n\t\t// template para listado de resultados por partido\n\t\ts.cont_results = $(\"#results\"); // contenedor ul para los partidos (barras)  \n\t\ts.tmpl_li_partido = Handlebars.compile($('#tmpl_li_partido').html());\n\t\ts.tmpl_x_interna = Handlebars.compile($('#tmpl_x_interna').html());\n\t\t\n\t\t// s.pintar_mapa();\n\t\t\n\t\ts.draw_ul_list();\n\n\n\t\t// template tooltip\n\t\ts.tooltip = $(\"#tooltip\"); // contenedor ul para los partidos (barras)  \n\t\ts.tmpl_tooltip = Handlebars.compile($('#tmpl_tooltip').html());\n\n\t\ts.on_click_comuna();\n\t\t\n// ***********\n\t\ttooltip(); // esta en scripts.js\n\n\n\t})();\n\n\tthis.set_data_active = set_data_active;\n};\n\n\nElecionesApp.prototype.get_ganadores_x_comuna = function(data){\n\t// toma todos los ganadores por comuna y pinta el mapa\n\tvar s = this;\n\ts.ganadores_comunas = [];\n\tfor (var com in data){\n\t\tif(!/c\\_0{2}|r/i.test(com)){ // que no sea la comuna 00\n\t\t\tvar i = 0;\n\n\t\t\twhile(/BLC|NUL|REC|IMP/i.test(data[com][i].id)){\n\t\t\t\ti += 1;\n\t\t\t\tif(i>15){\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar c = data[com][i];\n\t\t\tc.comuna = com.replace(/\\_0?/, \"\");\n\t\t\ts.ganadores_comunas.push(c);\n\t\t}\n\t}\n\ts.pintar_mapa();\n};\n\nElecionesApp.prototype.select_comuna_interna = \tfunction(polygon){\n\tvar s = this;\n\tvar id = polygon.id.replace(/c/i, \"\");\n\tvar com_name = \"Comuna \"+ id;\n\ts.set_data_active(com_name);\n\n\ts.q.set(\"comuna\", id);\n\n\t// data temporal\n\tvar data = {\n\t\ttotal:s.internas.comunas[\"comuna_\"+id],\n\t\tporcentaje: 33.5\n\t};\n\t// !data temporal\n\t\n\ts.draw_x_interna(data);\n\n};\n\n\nElecionesApp.prototype.select_comuna_general = \tfunction(polygon){\n\tvar s = this;\n\n\tvar id = polygon.id.replace(/c/i, \"\");\n\tvar com_name = \"Comuna \"+ id;\n\ts.set_data_active(com_name);\n\n\ts.set_comuna_active_path(polygon);\n\n\ts.q.set(\"comuna\", id);\n\n\t// lista de partidos x comuna\n\ts.draw_ul_list(id);\n};\n\n\nElecionesApp.prototype.on_click_comuna = function (){\n\tvar s = this;\n\t// click mapa\n\t$('polygon, path').on('click.on_comuna', function(e){\n\t\t\n\t\tif(s.filtro_activo == s.filtro_home){ // dropdown x fuerza\n\t\t\t\n\t\t\ts.select_comuna_general(this);\n\t\t\n\t\t}else{ // dropdown x interna o listas únicas\n\t\t\ts.select_comuna_interna(this);\n\n\t\t\n\t\t}\n\n\t});\n};\n\n\nElecionesApp.prototype.reset = function (){\n\tvar s = this;\n\t// resetea el los filtros\n\t$(\"#selected h4\").hide().html(\"\");\n\t\n\ts.remove_comuna_active_path();\n\tif(this.filtro_activo == this.filtro_home){ // dropdown x fuerza\n\t\ts.get_ganadores_x_comuna(s.r_general);\n\t\ts.draw_ul_list();\n\t\ts.q.kill(\"comuna\");\n\n\t}else{ // dropdown x interna o listas únicas\n\t\ts.draw_x_interna();\n\n\t}\n\t// clear radio btn\n\t$('li.candidato.active input').prop('checked', false);\n\t$('li.candidato.active').removeClass('active');\n\t\n};\n\nElecionesApp.prototype.get_max_obj = function(arr, key){ \n\t\n\tvar max = arr.map(function(x){ return x[key]; });\n\treturn Math.max.apply(null, max); \n};\n\nElecionesApp.prototype.sort_obj = function(arr, key){ \n\tfunction compare(a,b) {\n\t  if (a[key] > b[key])\n\t     return -1;\n\t  if (a[key] < b[key])\n\t    return 1;\n\t  return 0;\n\t}\n\treturn arr.sort(compare);\n};\n\nElecionesApp.prototype.draw_ul_list = function(id){ // si no viene data, escribe la general\n\t\n\tvar is_comuna = false;\n\tvar data;\n\tif(!id){\n\t\tdata = this.r_general.c_00;\n\t}else{\n\t\tid = (id < 10) ? \"0\"+id: id; // make id for data\n\t\tdata = this.r_general[\"c_\"+id];\n\t\tis_comuna = true;\n\t}\n\t// this.sort_obj(data, 'p'); // ya viene ordenado\n\tvar max = data.map(function(x){ return x.p; });\n\tvar l = {\n\t\tdata : data,\n\t\tdict_candidatos: this.dict_candidatos,\n\t\tdict_partidos: this.dict_partidos,\n\t\tis_comuna: is_comuna,\n\t\tmax : this.get_max_obj(data, \"p\")\n\t};\n\n\tthis.cont_results.html(this.tmpl_li_partido(l));\n\tif(is_comuna){ $(\".help_text, #line\").hide();}else{$(\".help_text, #line\").show();}\n\n// start niceScroll\n\tthis.start_niceScroll(\"#list\");\n\n};\n\n\nElecionesApp.prototype.cache_ajax = {};\n\nElecionesApp.prototype.draw_x_interna = function(val){ // recive el id del partido requerido\n\tvar s = this;\n\tvar key_cache = \"partido_\" + val;\n\tif(!s.cache_ajax[key_cache]){ // si no esta en cache lo va a buscar...\n\t\t\n\t\t$.get(\"data/\" + key_cache + \".json\", function(data){\n\t\t\ts.cache_ajax[key_cache] = data;\n\t\t\trun_interna(key_cache);\n\t\t});\n\n\t}else{\t\n\t\t\trun_interna(key_cache);\n\t}\n\n\tfunction run_interna(key_cache){\n\t\tvar data = {\n\t\t\tcomunas : s.cache_ajax[key_cache],\n\t\t\tmax: s.cache_ajax[key_cache].c_00[0].p,\n\t\t\tdict_candidatos: s.dict_candidatos\n\t\t};\n\t\ts.cont_results.html(s.tmpl_x_interna(data));\n\t\ts.get_ganadores_x_comuna(s.cache_ajax[key_cache]);\n\t\t\t\n\t\t\n\t\t// bind events for inputs\n\t\tvar candidato_btn = $('input[type=\"radio\"]');\n\t\tcandidato_btn.on('click.select_condidato', function(el){\n\t\t\tvar $el = $(this);\n\t\t\t$('li.active:has(input)').removeClass('active');\n\t\t\t$el.closest('li').addClass('active');\n\n\t\t\ts.set_data_active(this.value);\n\t\t\ts.q.set(\"candidato\", this.value);\n\t\t});\n\n\t// start niceScroll\n\t\ts.start_niceScroll();\n\t}\n};\n\nElecionesApp.prototype.draw_tooltip = function(data){\n\tthis.tooltip.html(this.tmpl_tooltip(data));\n};\n\nElecionesApp.prototype.remove_comuna_active_path = function(){\n\tif(this.comuna_active_path){\t\n\t\tthis.comuna_active_path.remove();\n\t}\n\n};\n\nElecionesApp.prototype.set_comuna_active_path = function(polygon){\n\tthis.remove_comuna_active_path();\n\tthis.comuna_active_path = $(polygon).clone();\n\tthis.comuna_active_path.attr(\"class\",\"comuna_active_path\");\n\t$(\"svg\").append(this.comuna_active_path);\n\n};\n\n\nElecionesApp.prototype.change_dropdown = function(val){\n\tvar s = this;\n\ts.filtro_activo = val;\n\t\n\t$('#ayud1').hide();\n\t$('.compartir').show();\n\n\tif(s.filtro_home == s.filtro_activo){\n\t\ts.get_ganadores_x_comuna(s.r_general);\n\t\ts.draw_ul_list();\n\t}else{\t\n\t\ts.draw_x_interna(val);\n\t}\n\t// set path\n\ts.q.set('fuerza', val);\n\ts.remove_comuna_active_path();\n\n\n};\n\nElecionesApp.prototype.start_niceScroll = function(selector){\n\t$(selector).niceScroll({\n\t\tcursorcolor:\"#d7d7d7\",\n\t\tcursorborder:\"0px solid #fff\",\n\t\tcursorwidth: \"7px\",\n\t\tautohidemode:false,\n\t\thidecursordelay:0\n\t});\n};\n\n\nElecionesApp.prototype.pintar_mapa = function(){\n\tvar s = this;\n\t\n\tvar fill = \"#000\";\n\t\n\tif(this.filtro_activo == this.filtro_home){\n\t\ts.ganadores_comunas.forEach(function(x){\n\t\t\t$(\"#\"+x.comuna).css({ fill: s.dict_partidos[x.id].color_partido});\n\t\t});\n\t}else{\n\t\t// s.ganadores_comunas.forEach(function(x){\n\t\t// \tfill = s.dict_candidatos[x.id] ? s.dict_candidatos[x.id].color_candidato : \"#ccc\";\n\t\t// \t$(\"#\"+x.comuna).css({ fill: fill});\n\t\t\n\t\t// });\n\t\tvar x = s.ganadores_comunas[0];\n\t\tfill = s.dict_candidatos[x.id] ? s.dict_candidatos[x.id].color_candidato : \"#ccc\";\n\t\t// setar el color del partido para los patterns\n\t\t$(\"path, polygon\").css({ fill: fill});\n\t\t$(\"#refes rect#masVotos\").css({ fill: fill});\n\t\t$(\"line\").css({ stroke: fill});\n\n\t}\n};\n\n\nElecionesApp.prototype.barios_x_com = {\n\t  \"c1\": \"Recoleta\",\n\t  \"c2\": \"Palermo\",\n\t  \"c3\": \"Barracas, Boca, Nueva Pompeya, Parque Patricios \",\n\t  \"c4\": \"Constitución, Monserrat, Puerto Madero, Retiro, San Nicolás, San Telmo\",\n\t  \"c5\": \"Belgrano, Colegiales, Nuñez\",\n\t  \"c6\": \"Almagro, Boedo\",\n\t  \"c7\": \"Caballito\",\n\t  \"c8\": \"Flores, Parque Chacabuco\",\n\t  \"c9\": \"Liniers, Mataderos, Parque Avellaneda\",\n\t  \"c10\": \"Floresta, Monte Castro, Velez Sarsfield, Versalles, Villa Luro, Villa Real\",\n\t  \"c11\": \"Villa Del Parque, Villa  Devoto, Villa Gral. Mitre, Villa Santa Rita\",\n\t  \"c12\": \"Coghlan, Saavedra, Villa Pueyrredón, Villa Urquiza\",\n\t  \"c13\": \"Balvanera, San Cristobal\",\n\t  \"c14\": \"Agronomía, Chacarita,  Parque Chas,  Paternal, Villa Crespo, Villa Ortuzar\",\n\t  \"c15\": \"Villa Lugano, Villa Riachuelo, Villa Soldati\"\n\t};\n\nElecionesApp.prototype.q = new PermanentLinkJS();\n\nElecionesApp.prototype.colores = [\"#FEDB30\",\"#1796D7\",\"#7CC374\",\"#F4987E\",\"#B185B7\",\"#B3B3B3\"];\n\n\n","var PermanentLinkJS = function() {\n\t\"use strict\";\n\n\tvar query = {};\n\n\tfunction reset(){ \n\t\tquery = {};\n\t\tset_hash();\n\t\treturn query;\n\t}\n\n\tfunction set(key, val) {\n\t\tif (typeof key == 'object'){\n\t\t\ttry{\n\t\t\t\tfor (var k in key){\n\t\t\t\t\tquery[k] = key[k];\t\n\t\t\t\t}\n\t\t\t}catch(err){\n\t\t\t\tconsole.error(\"Error set query: %s\", err.message);\n\t\t\t}\n\t\t}else{\n\t\t\ttry{\n\t\t\t\tquery[key] = val;\n\t\t\t\tset_hash();\n\t\t\t}catch(err){\n\t\t\t\tconsole.error(\"Error set query: %s\", err.message);\n\t\t\t}\n\t\t}\n\t\treturn query;\n\t}\n\t\n\tfunction get_parameters(str) {\n\t\tstr = str || location.hash;\n\t\treturn str.replace(\"#\", \"\").split(\"&\").map(function(n){return n = n.split(\"=\"),this[n[0]] = n[1],this;}.bind({}))[0];\n\t}\n\n\tfunction set_from_location(){\n\t\treturn (query = get_parameters());\n\t}\n\n\tfunction kill(k){ \n\t\tdelete query[k]; \n\t\tset_hash();\n\t\treturn query;\n\t}\n\n\tfunction to_string(o){\n\t\tvar s = [];\n\t\tfor(var k in o){\n\t\t\ts.push([k, o[k]].join(\"=\"));\n\t\t}\n\t\treturn s.join(\"&\");\n\t}\n\n\tfunction set_hash(q) {\n\t\tq = typeof q == \"string\" ? q : to_string(q || query);\n\t\ttry{\n\t\t\treturn (location.hash = q);\n\t\t}catch(err){\n\t\t\tconsole.error(\"Error set_hash: %s\", err.message);\n\t\t}\n\t}\n\n\tthis.get_query = function() { return query; };\n\t\n\tthis.reset = reset;\n\tthis.get_parameters = get_parameters;\n\tthis.to_string = to_string;\n\tthis.set_hash = set_hash;\n\tthis.set = set;\n\tthis.kill = kill;\n\tthis.set_from_location = set_from_location;\n};\n\n","// scripts app\nvar app;\n\nvar ancho = $(window).width();\nvar isMobile = { //valida si es un dispositivo movil\n    Android: function() {\n        return navigator.userAgent.match(/Android/i);\n    },\n    BlackBerry: function() {\n        return navigator.userAgent.match(/BlackBerry/i);\n    },\n    iOS: function() {\n        return navigator.userAgent.match(/iPhone|iPad|iPod/i);\n    },\n    Opera: function() {\n        return navigator.userAgent.match(/Opera Mini/i);\n    },\n    Windows: function() {\n        return navigator.userAgent.match(/IEMobile/i);\n    },\n    any: function() {\n        return (isMobile.Android() || isMobile.BlackBerry() || isMobile.iOS() || isMobile.Opera() || isMobile.Windows());\n    }\n};\n\n$(function(){\n    \n\t\"use strict\";\n    // $.ajaxSetup({ cache: false }); \n\t// load mapa\n\t$.get(\"img/caba_ilus.txt\", function(mapa){\n\t\t// get list partidos\n\t\t$.get(\"data/diccionario_partidos.json\", function(dict_partidos){\n\t\t\t$.get(\"data/diccionario_candidatos.json\", function(dict_candidatos){\n\t\t\t\t\n\t\t\t\t$.get(\"data/partido_00.json\", function(results){\n\n\t\t\t\t\t$(\"#mapa_cont\").html(mapa + '<div class=\"ayuda2\">FILTRAR POR CANDIDATO</div><div class=\"ayuda3\">Clickeá en las comunas para ver los resultados en detalle.</div></div>');\n\t\t\t\t\t// init app\n\t\t\t\t\t\n\t\t\t\t\tapp = new ElecionesApp(dict_partidos, dict_candidatos, results);\n\n\t\t\t\t\t/* select */\n\t\t\t\t\t\n\t\t\t\t\t$(\"#opts\").select2({\n\t\t\t\t        minimumResultsForSearch: -1,\n\t\t\t\t        val: \"x_fuerza\"\n\t\t\t\t    });\n\n\t\t\t\t\t\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\n\t\t// tooltip(); lo llama elecciones_app.js\n\t\n\t});\n\n\t \n\t  \n\t\t/*compartir*/\n\t\tfunction myPopup(url) {\n\t   \t \twindow.open( url, \"Compartir\", \"status = yes, height = 360, width = 500, resizable = yes, left = \"+(ancho/2+250)+\", top =\" +(alto/2-150) );\n\t    \treturn false;\n\t\t}\n\n});\n\n\n\n\n\n\t/* // tooltip /*/\nfunction tooltip(){\n\n\tvar comu = $(\"polygon, path\");\n\tvar toolip = $(\".tooltip\");\n\n\tcomu.on( 'mouseenter', function() {\n\n\t\t$el = $(this);\n\n\t\tide = $el.attr(\"id\").replace(/c/i, \"\");\n\t\t\n\t\tif(app.filtro_activo == \"x_fuerza\"){\n\t\t\tide = ide < 10 ? \"0\"+ide : ide;\n\t\t\tvar data = app.r_general[\"c_\"+ide];\n\t\t\tvar max = data[0].p;\n\t\t\tdata = data.slice(0, 3).map(function(d){\n\t\t\t\td.color = app.dict_partidos[d.id].color_partido;\n\t\t\t\td.nombre = app.dict_partidos[d.id].nombre_partido;\n\t\t\t\treturn d;\n\t\t\t});\n\t\t\t\n          \t// llenar popup\n\t\t\tapp.draw_tooltip({\n\t\t\t\tid:ide,\n\t\t\t\tmax: max,\n\t\t\t\tpartidos: data,\n\t\t\t\tbarios_x_com: app.barios_x_com[\"c\"+ide]\n\t\t\t});\n\n\t\t\ttoolip.show();\n\t\t\tmouse_move($el, toolip);\n\t\t}else{\n\t\t\t// tooltip por interna\n\n\t\t\tapp.draw_tooltip();\n\n\t\t}\n    \t\n    \t// animate tooltip\n        \n\n    });\n\n\tfunction mouse_move($el, toolip){\n\t    $el.on('mousemove', function(e){\n\t      \n\t         e = e || window.event;\n\t         e = jQuery.event.fix(e);\n\t         \n\t        var itemX = e.pageX - 200;\n\t\t\tif(e.pageX > 185 && ancho < 750){\n\t\t\t\titemX = e.pageX - 200;\n\t\t\t}else if(e.pageX < 330){\n\t\t\t\titemX = e.pageX;\n\t\t\t}\n\n\t         if(e.pageY > 350 && ancho < 750){\n\t\t\t\titemY = e.pageY - 260;\n\t         }else if(e.pageY > 350){\n\t\t\t\titemY = e.pageY - 260;\n\t         }else{\n\t\t\t\titemY = e.pageY + 30;\n\t         }\n\n\t         $(\".tooltip\").animate({\"top\":itemY, \"left\":itemX},100, 'swing').stop( true, true );\n\n\t    });\n\n\t    if(isMobile.any()) {\n\t\t           \n\t    }else{\n\t\t\t\n\t\t\t$el.on('mouseout', function(){\n\t        \ttoolip.hide();\n\t\t\t});\t\n\t    }\n\t}\n}\n\n"],"sourceRoot":"/source/"}