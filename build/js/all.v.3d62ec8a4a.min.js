var PermanentLinkJS=function(){"use strict";function t(){return c={},i(),c}function r(t,r){if("object"==typeof t)try{for(var e in t)c[e]=t[e]}catch(n){console.error("Error set query: %s",n.message)}else try{c[t]=r,i()}catch(n){console.error("Error set query: %s",n.message)}return c}function e(t){return t=t||location.hash,t.replace("#","").split("&").map(function(t){return t=t.split("="),this[t[0]]=t[1],this}.bind({}))[0]}function n(){return c=e()}function s(t){return delete c[t],i(),c}function o(t){var r=[];for(var e in t)r.push([e,t[e]].join("="));return r.join("&")}function i(t){t="string"==typeof t?t:o(t||c);try{return location.hash=t}catch(r){console.error("Error set_hash: %s",r.message)}}var c={};this.get_query=function(){return c},this.reset=t,this.get_parameters=e,this.to_string=o,this.set_hash=i,this.set=r,this.kill=s,this.set_from_location=n};
var ElecionesApp=function(t,a,o,e){"use strict";function i(t){$("#selected h4").html(t).fadeIn()}var c=this;c.dict_partidos=t,c.dict_candidatos=a,c.path_to_data=e,c.r_general=o,c.internas=o.interna,c.comuna_active_path=null,c.filtro_home="00",c.filtro_activo="00",function(){c.get_ganadores_x_comuna(c.r_general),$("select#opts").change(function(){c.change_dropdown($(this).val())}),$("h3").on("click",function(){c.filtro_activo=c.filtro_home,c.reset(),$("select#opts").select2("val",c.filtro_home)}),c.tmpl_opts=Handlebars.compile($("#tmpl_opts").html()),$("#opts").html(c.tmpl_opts(c.dict_partidos)),c.cont_results=$("#results"),c.tmpl_li_partido=Handlebars.compile($("#tmpl_li_partido").html()),c.tmpl_x_interna=Handlebars.compile($("#tmpl_x_interna").html()),c.draw_ul_list(),c.get_mesas_escrutadas(),c.tooltip=$("#tooltip"),c.tmpl_tooltip=Handlebars.compile($("#tmpl_tooltip").html()),c.tmpl_tooltip_interna=Handlebars.compile($("#tmpl_tooltip_interna").html()),c.on_click_comuna(),tooltip()}(),this.set_data_active=i};ElecionesApp.prototype.cache_ajax={},ElecionesApp.prototype.reset_cache_ajax=function(){this.cache_ajax={}},ElecionesApp.prototype.reload_app=function(){console.log("reload data!");var t=this;t.reset_cache_ajax()},ElecionesApp.prototype.get_r_general=function(t){var a=this;$.get(a.path_to_data+"partido_00.json",function(o){a.r_general=o,t&&t()})},ElecionesApp.prototype.get_mesas_escrutadas=function(t){var a=this;$.get(a.path_to_data+"resumen.json",function(o){a.resumen=o,$("#mesas span").html(a.resumen.mp+"%"),$("#votos span").html(a.resumen.vp+"%"),$("#padron span").html((+a.resumen.e).format(0,",",".")),t&&t()})},ElecionesApp.prototype.draw_x_interna=function(t){var a=this,o="partido_"+t;a.cache_ajax[o]?a.run_interna(o):$.get(a.path_to_data+o+".json",function(t){a.cache_ajax[o]=t,a.run_interna(o)})},ElecionesApp.prototype.animate_barras=function(){$("#results .cont_barra .barra").each(function(){var t=$(this);t.delay(500).animate({width:t.data("width")},{duration:900,queue:!1})})},ElecionesApp.prototype.get_ganadores_x_comuna=function(t){var a=this;a.ganadores_comunas=[];for(var o in t)if(!/c\_0{2}|r/i.test(o)){for(var e=0;/BLC|NUL|REC|IMP/i.test(t[o][e].id)&&(e+=1,!(e>15)););var i=t[o][e];i.comuna=o.replace(/\_0?/,""),a.ganadores_comunas.push(i)}a.pintar_mapa()},ElecionesApp.prototype.select_comuna_interna=function(t){var a=this,o=t.id.replace(/c/i,""),e="Comuna "+o;a.set_data_active(e);var i="c_"+(10>o?"0"+ +o:o),c="partido_"+a.filtro_activo;a.run_interna(c,i),a.q.set("comuna",o),a.set_comuna_active_path(t)},ElecionesApp.prototype.select_comuna_general=function(t){var a=this,o=t.id.replace(/c/i,""),e="Comuna "+o;a.set_data_active(e),a.set_comuna_active_path(t),a.q.set("comuna",o),a.draw_ul_list(o)},ElecionesApp.prototype.on_click_comuna=function(){var t=this;$("polygon, path").on("click.on_comuna",function(){t.filtro_activo==t.filtro_home?t.select_comuna_general(this):t.select_comuna_interna(this)})},ElecionesApp.prototype.reset=function(){var t=this;$("#selected h4").hide().html(""),t.remove_comuna_active_path(),this.filtro_activo==this.filtro_home?(t.get_ganadores_x_comuna(t.r_general),t.draw_ul_list(),t.q.kill("comuna")):t.draw_x_interna(this.filtro_activo),$("li.candidato.active input").prop("checked",!1),$("li.candidato.active").removeClass("active")},ElecionesApp.prototype.get_max_obj=function(t,a){var o=t.map(function(t){return t[a]});return Math.max.apply(null,o)},ElecionesApp.prototype.sort_obj=function(t,a){function o(t,o){return t[a]>o[a]?-1:t[a]<o[a]?1:0}return t.sort(o)},ElecionesApp.prototype.draw_ul_list=function(t){var a,o=!1;t?(t=10>t?"0"+t:t,a=this.r_general["c_"+t],o=!0):a=this.r_general.c_00;var e=(a.map(function(t){return t.p}),{data:a,dict_candidatos:this.dict_candidatos,dict_partidos:this.dict_partidos,is_comuna:o,max:this.get_max_obj(a,"p")});this.cont_results.html(this.tmpl_li_partido(e)),this.animate_barras(),o?$(".help_text, #line").hide():$(".help_text, #line").show(),this.start_niceScroll("#list")},ElecionesApp.prototype.run_interna=function(t,a){var o=this;a||(a="c_00");var e=o.cache_ajax[t],i={interna:e,comuna:e[a],r:o.cache_ajax[t].r,is_99:"99"==o.filtro_activo,max:o.cache_ajax[t][a][0].p,dict_candidatos:o.dict_candidatos};o.cont_results.html(o.tmpl_x_interna(i)),o.get_ganadores_x_comuna(o.cache_ajax[t]),o.animate_barras();var c=$('input[type="radio"]');c.on("click.select_condidato",function(){var t=$(this);$("li.active:has(input)").removeClass("active"),t.closest("li").addClass("active"),o.set_data_active(this.value),o.q.set("candidato",this.value)}),o.start_niceScroll("#list_interna")},ElecionesApp.prototype.draw_tooltip=function(t){this.tooltip.html(t)},ElecionesApp.prototype.remove_comuna_active_path=function(){this.comuna_active_path&&this.comuna_active_path.remove()},ElecionesApp.prototype.set_comuna_active_path=function(t){this.remove_comuna_active_path(),this.comuna_active_path=$(t).clone(),this.comuna_active_path.attr("class","comuna_active_path"),this.comuna_active_path.css("fill-opacity","0"),$("svg").append(this.comuna_active_path)},ElecionesApp.prototype.change_dropdown=function(t){var a=this;a.filtro_activo=t,a.reset(),$("#ayud1").hide(),$(".compartir").show(),a.q.kill("comuna"),a.filtro_home==a.filtro_activo?(a.get_ganadores_x_comuna(a.r_general),a.draw_ul_list()):a.draw_x_interna(t),a.q.set("fuerza",t),a.remove_comuna_active_path()},ElecionesApp.prototype.start_niceScroll=function(t){$(t).niceScroll({cursorcolor:"#d7d7d7",cursorborder:"0px solid #fff",cursorwidth:"7px",autohidemode:!1,hidecursordelay:0})},ElecionesApp.prototype.pintar_mapa=function(){var t=this,a="#fff";if($("path, polygon").css({fill:"#fff",stroke:a,"fill-opacity":"1"}),this.filtro_activo==this.filtro_home)t.ganadores_comunas.forEach(function(a){$("#"+a.comuna).css({fill:t.dict_partidos[a.id].color_partido})});else{var o=this.cache_ajax["partido_"+this.filtro_activo].c_00;t.ganadores_comunas.forEach(function(e){a=t.dict_candidatos[e.id]?t.dict_candidatos[e.id].color_candidato:"#ccc";var i={fill:a};e.id!=o[0].id&&(i["fill-opacity"]=".4",e.id!=o[1].id&&(i={fill:"#ccc"})),$("#"+e.comuna).css(i)}),t.ganadores_comunas.length<15&&$("path, polygon").css({stroke:"#ccc"})}},ElecionesApp.prototype.barios_x_com={c01:"Constitución, Monserrat, Puerto Madero, Retiro, San Nicolás, San Telmo",c02:"Recoleta",c03:"Balvanera, San Cristobal",c04:"Barracas, La Boca, Nueva Pompeya, Parque Patricios",c05:"Almagro, Boedo",c06:"Caballito",c07:"Flores, Parque Chacabuco",c08:"Villa Lugano, Villa Riachuelo, Villa Soldati",c09:"Liniers, Mataderos, Parque Avellaneda",c10:"Floresta, Monte Castro, Vélez Sarsfield, Versalles, Villa Luro, Villa Real",c11:"Villa Del Parque, Villa  Devoto, Villa Gral. Mitre, Villa Santa Rita",c12:"Coghlan, Saavedra, Villa Pueyrredón, Villa Urquiza",c13:"Belgrano, Colegiales, Núñez",c14:"Palermo",c15:"Agronomía, Chacarita,  Parque Chas,  Paternal, Villa Crespo, Villa Ortúzar"},ElecionesApp.prototype.q=new PermanentLinkJS,ElecionesApp.prototype.colores=["#FEDB30","#1796D7","#7CC374","#F4987E","#B185B7","#B3B3B3"];
function myPopup(t){return window.open(t,"Compartir","status = yes, height = 360, width = 500, resizable = yes, left = "+(ancho/2+250)+", top ="+(alto/2-150)),!1}function tooltip(){function t(t,i){t.on("mousemove",function(t){t=t||window.event,t=jQuery.event.fix(t);var i=t.pageX-200;t.pageX>185&&750>ancho?i=t.pageX-200:t.pageX<330&&(i=t.pageX),itemY=t.pageY>350&&750>ancho?t.pageY-260:t.pageY>350?t.pageY-260:t.pageY+30,$(".tooltip").animate({top:itemY,left:i},100,"swing").stop(!0,!0)}),isMobile.any()||t.on("mouseout",function(){i.hide()})}var i,a=$("polygon, path"),e=$(".tooltip"),o="";a.on("mouseenter",function(){if($el=$(this),ide=$el.attr("id").replace(/c/i,""),ide=ide<10?"0"+ide:ide,app.filtro_activo==app.filtro_home){i=app.r_general["c_"+ide];var a=i[0].p;i=i.slice(0,3).map(function(t){return t.color=app.dict_partidos[t.id].color_partido,t.nombre=app.dict_partidos[t.id].nombre_partido,t}),o=app.tmpl_tooltip({id:ide,max:a,partidos:i,barios_x_com:app.barios_x_com["c"+ide]})}else{var n=app.filtro_activo;i=app.cache_ajax["partido_"+n]["c_"+ide].slice(0,3),i=i.map(function(t){return t.color=app.dict_candidatos[t.id]?app.dict_candidatos[t.id].color_candidato:"#ccc",t.apellido=app.dict_candidatos[t.id]?app.dict_candidatos[t.id].apellido:"#ccc",t}),o=app.tmpl_tooltip_interna({id:ide,max:i[0].p,candidatos:i,interna:app.cache_ajax["partido_"+n],barios_x_com:app.barios_x_com["c"+ide]})}app.draw_tooltip(o),e.show(),t($el,e)})}var app,ancho=$(window).width(),alto=$(window).height();$(window).resize(function(){ancho=$(window).width(),alto=$(window).height()});var isMobile={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return isMobile.Android()||isMobile.BlackBerry()||isMobile.iOS()||isMobile.Opera()||isMobile.Windows()}};$(function(){"use strict";var t="http://datapaso.lanacion.com.ar/json_data/";$.get("img/caba_ilus.txt",function(i){$.get("dicts/diccionario_partidos.json",function(a){$.get("dicts/diccionario_candidatos.json",function(e){$.get(t+"partido_00.json",function(o){function n(t){for(var i,a,e,o=0,n=0,r=0,c=t.length,d=0,p=c-1;c>d;p=d++)i=t[d],a=t[p],e=i.x*a.y-a.x*i.y,o+=e,n+=(i.x+a.x)*e,r+=(i.y+a.y)*e;return e=3*o,{x:n/e,y:r/e}}function r(t,i,a){var e=document.createElementNS(c,"text");e.setAttributeNS(null,"x",t),e.setAttributeNS(null,"y",i),e.setAttributeNS(null,"font-size",15),e.setAttributeNS(null,"fill","#fff");var o=document.createTextNode(a.id.replace("c",""));e.appendChild(o),$("#mapa_cont svg").append(e)}$("#mapa_cont").html(i+'<div class="ayuda2">FILTRAR POR CANDIDATO</div><div class="ayuda3">Clickeá en las comunas para ver los resultados en detalle.</div></div>'),app=new ElecionesApp(a,e,o,t),$("#opts").select2({minimumResultsForSearch:-1,val:"x_fuerza"});var c="http://www.w3.org/2000/svg";$("polygon").each(function(t,i){{var a=n(i.points);i.getBBox()}r(a.x,a.y,i)}),$("path").each(function(t,i){var a=i.getBBox();r(a.x+a.width/2-10,a.y+a.height/2+10,i)}),$(".creditos").click(function(){$(".creVent").fadeIn(200),$(".creVent .txts").delay(300).fadeIn(200)}),$(".cerrar").click(function(){$(".creVent .txts").fadeOut(200),$(".creVent").delay(300).fadeOut(200)})})})})})}),Number.prototype.format=function(t,i,a){var e=this;t=isNaN(t=Math.abs(t))?2:t,i=void 0===i?".":i,a=void 0===a?",":a;var o=0>e?"-":"",n=parseInt(e=Math.abs(+e||0).toFixed(t))+"",r=(r=n.length)>3?r%3:0,c=o+(r?n.substr(0,r)+a:"")+n.substr(r).replace(/(\d{3})(?=\d)/g,"$1"+a)+(t?i+Math.abs(e-n).toFixed(t).slice(2):"");return c};
//# sourceMappingURL=../js/all.v.3d62ec8a4a.min.js.map